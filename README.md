# ECG 신호 분류를 위한 LSTM 모델 프로젝트

## 프로젝트 개요
본 프로젝트는 장단기 기억 신경망(LSTM)을 사용하여 심전도(ECG) 신호를 분류하는 기술을 개발합니다. 심전도 신호는 심장의 전기적 활동을 기록한 것으로, 이를 분석하여 부정맥과 같은 심장 질환을 진단하는 데 활용할 수 있습니다.

## 데이터
본 연구에서는 두 가지 데이터 세트를 사용하였습니다.
- **PhysioNet/CinC Challenge 2017 데이터**: 정상, 심방세동(AF), 기타 리듬, 잡음의 네 가지 클래스로 분류되는 30초에서 60초 사이의 단일 ECG 리드 기록 데이터
- **MIT-BIH 부정맥 데이터베이스**: 30분 길이의 2채널 ECG 데이터로, 정상 및 부정맥 데이터를 포함

## LSTM 모델
본 연구에서는 양방향 LSTM 모델을 사용하였습니다. 
- **양방향 처리**: 입력 데이터를 앞쪽(정방향)과 뒤쪽(역방향) 모두에서 처리하여 더 풍부한 정보를 학습
- **장기 의존성 학습**: 셀 상태와 게이트 구조를 통해 정보 손실을 방지하고, 필요한 정보를 선택적으로 유지하며 불필요한 정보는 잊음

## 기술 스택
### 주요 언어
- Python, MATLAB

### 딥러닝 프레임워크
- MATLAB Deep Learning Toolbox

### 웹 프레임워크
- Streamlit

### 기타 라이브러리
- `scipy.io` (MAT 파일 로드)
- `wfdb` (HEA/DAT 파일 로드)
- `onnxruntime` (ONNX 모델 실행)
- `numpy`, `pandas`, `matplotlib.pyplot`, `scipy.signal`, `seaborn`

## 소프트웨어 구현
- **MATLAB**: ECG 신호 처리, LSTM 네트워크 설계 및 훈련, 데이터 분석
- **Streamlit**: 데이터 시각화, 머신러닝 모델 배포, 대화형 애플리케이션 구축

## 웹사이트 개발
Streamlit을 사용하여 개발한 웹사이트는 다음과 같은 기능을 제공합니다.
- **.mat, .hea, .dat 파일 업로드**: ECG 신호 파일을 업로드하여 분석 가능
- **부정맥 진단 결과 및 확률**: 업로드된 ECG 신호에 대한 부정맥 여부와 확률을 예측하여 표시
- **특징 확인 및 판단 이유**: 순시 주파수, 스펙트럼 엔트로피 등 모델의 판단 근거를 시각적으로 제공
- **파형 확인 (QRS 및 P파)**: ECG 신호에서 주요 특징을 시각화하여 제공

## 프로젝트 이슈 및 개선 사항
- 원시 신호 데이터를 사용한 학습에서 낮은 성능을 보였으나, 시간-주파수 정보(순시 주파수, 스펙트럼 엔트로피)를 사용하여 성능 개선
- 젯슨 나노 보드에서 파일 업로드 시 `.hea` 파일뿐만 아니라 `.mat` 또는 `.dat` 파일을 함께 업로드해야 정상적으로 처리됨을 확인하고 문제 해결
- 낮은 예측 정확도를 개선하기 위해 예측 평균값을 고정 소수점에서 부동 소수점으로 변환하고, 훈련 옵션을 MATLAB과 유사하게 설정
- 파형의 길이가 너무 길어 샘플 수를 조정하고, ECG 신호의 스케일을 조정하여 시각화 결과 개선
- UI 개선을 위해 순시 주파수 및 엔트로피 분포도를 나타내는 히스토그램을 추가하려 했으나, 정상 및 부정맥 데이터에서 뚜렷한 차이가 없는 경우 제외

